% !TeX spellcheck = sv_SE
\documentclass[a4paper,11pt,twoside]{report}
\usepackage[swedish]{babel}
\usepackage{t1enc}
\usepackage[dvips]{graphicx}
\usepackage{listings}
\usepackage{color}

\usepackage{amsthm}
\usepackage{bbm}
\usepackage{graphicx}

\DeclareGraphicsExtensions{.png,.pdf,.jpg}

\textheight=24.0cm
\textwidth=15.1cm

\topmargin=-1.5cm
%\headheight=0cm
\headsep=0.7cm
\oddsidemargin=0.4cm
\evensidemargin=0.4cm
%\columnsep=0.8cm
\footskip=1.5cm
\setcounter{secnumdepth}{0}
\pagestyle{empty}
%\markboth{}{Namn: \hfill Personnr: \hfill}
%\markboth{DD1339 inda13}{DD1339 inda13}

\newcommand{\ttt}[1]{\texttt{#1}}

\newcommand{\HRule}{\rule{\linewidth}{0.5mm}}

\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}

\lstdefinestyle{mystyle}{
	language=C,
	commentstyle=\color{codegreen},
	keywordstyle=\color{magenta},
	numberstyle=\tiny\color{codegray},
	stringstyle=\color{codepurple},
	basicstyle=\footnotesize,
	breakatwhitespace=false,         
	breaklines=true,                 
	captionpos=b,                    
	keepspaces=true,                 
	numbers=left,                    
	numbersep=5pt,
	rulecolor=\color{black},                  
	showspaces=false,                
	showstringspaces=false,
	showtabs=false,
	stepnumber=2,                  
	tabsize=2
}

\lstset{style=mystyle}

\begin{document}
\begin{titlepage}
	\begin{center}
		
		~\vspace{1.75cm} ~
		
		\textsc{\Large Projektarbete \\ Introduktion till datalogi \\[0.25cm] DD1339, inda14}\\[1.75cm]
		
		% Title
		{ \huge \HRule\\[0.4cm] \bfseries Pirates of Pang Pang\\[0.4cm]}
		
		\HRule \\[0.5cm]
		
		{\large A game for landlubbers to feel the breeze of the seven seas} \\ [1.5cm]
		
		\large Alexander Viklund
		\\[0.1cm] \large August Falk
		\\[3cm] Description: Pirates is a game where you face your friends in a fierce deathbattle. You control your own pirate ship and use its cannons to shoot down your foes.
		
		\vfill
		
		
		% Bottom of the page
		
		{\large \today}
		
	\end{center}
\end{titlepage}
\section{Programbeskrivning}
\subsection{A}
Programmet kommer att vara ett enkelt tvåpersonsspel.
Spelet kommer i grunden att gå ut på att man styr varsitt piratskepp och försöker skjuta ner varandra.

\subsubsection{Syfte}
Spelets syfte är att vara ett kul socialt tidsfördriv.

Vi har valt att göra detta spel, då vi minns från vår ungdoms dagar hur roligt det var att spela flashspelet ''achtung die kurve'' och vill återskapa glädjen av att sitta ett gäng kompisar runt en dator och skrika på varandra.

\subsection{B}
Programmet är ett tvåpersonsspel där man styr varsitt piratskepp och försöker skjuta på varandra. När en spelare har fått slut på liv så vinner den andra spelaren och en ny omgång kan påbörjas.

\subsection{C}
Programbeskrivningen var kanske inte så ingående men vårt slutresultat passar väl in på den ursprungliga programbeskrivningen.

\section{Användarbeskrivning}
\subsection{A}
Vi riktar oss mot andra studenter och spelintresserade som vill ha ett kul tidsfördriv.

Vi förväntar oss att användarna har spelat enkla flash-spel förut och klarar av att navigera i en simpel meny. Inte så mycket alltså.

\subsection{B}
Vi riktar oss mot andra studenter och spelintresserade som vill ha ett kul tidsfördriv.

Vi förväntar oss att användarna har spelat enkla flash-spel förut och klarar av att navigera i en simpel meny. Inte så mycket alltså.

Användaren bör också ha en viss tolerans mot buggar.

\subsection{C}
Inget som vi gjorde under projektet ändrade vilken användare vi riktade oss mot.

\section{Användarscenarier}
\subsection{A}
Två användare sitter efter lunch och har inget att göra, så de bestämmer sig för att spela vårt spel. De sätter sig vid en dator och startar en spelomgång. Vid datorns tangentbord har de varsin uppsättning knappar för att navigera och skjuta. Efter att ha skjutit och rammat varandra ett tag så får en av användarna slut på hitpoints och hans skepp sjunker och han förlorar. Efter matchen frågar programmet om de vill köra en till omgång men användarna bestämmer sig för att göra något annat så de stänger ner programmet.
\begin{figure}[h!]
	\centering
	\includegraphics[width=0.3\textwidth , angle=270]{Bilder/Meny}
	%\caption{Spelets huvudmeny}
	\includegraphics[width=0.3\textwidth , angle=270]{Bilder/Game}
	\caption{Huvudmeny och spelplan}
\end{figure}

\subsection{B}
Två användare sitter efter lunch och har inget att göra, så vi tvingar dem att spela vårt spel. De sätter sig vid en dator och startar en spelomgång. Spelets meny navigeras med tangentbordet och det tar ett tag för användarna att sluta använda musen. Vid datorns tangentbord har de varsin uppsättning knappar för att navigera och skjuta. Efter att ha skjutit och rammat varandra ett tag så får en av användarna slut på hitpoints och hans skepp sjunker och han förlorar. Efter matchen frågar programmet om de vill köra en till omgång men vi stoppar dem för det är buggat just nu. Ja, det här scenariot hände.

\begin{figure}[h!]
	\centering
	\includegraphics[width=0.4\textwidth]{Bilder/nyMeny}
	%\caption{Spelets huvudmeny}
	\includegraphics[width=0.4\textwidth]{Bilder/nyGame}
	\caption{Slutgiltig huvudmeny och spelplan}
\end{figure}
\subsection{C}
Scenariot blev ungefär så som vi tänkte oss. Det kom upp lite småsaker som vi inte hade tänkt oss men användarupplevelsen var densamma.

\section{Testplan}
\subsection{A}
Vi vill använda oss mest av användartester, för att se hur enkelt det är att förstå spelet och hur vi kan göra det roligare och väl balanserat. 

Sen tänker vi också skriva lite unit-tester för bland annat kollisioner och annan logik som är enkel att testa.

Vi vill att användarna ska genomföra 2 tester. 

\subsection{Användartester}

Användare ska utan tidigare kunskap om programmet kunna utföra följande scenarion utan större svårigheter.

\subsubsection{Scenario 1}

Användaren ska kunna navigera huvudmenyn för och ändra spelets inställningar. Användaren ska förstå vad inställningarna betyder och vad deras ändringar gör.

\subsubsection{Scenario 2}

Användaren ska kunna starta en spelomgång och spela utan att vara förhindrad av okunskap gällande spelets regler och kontroller.

\subsection{B}
Vi använde användartester för att hitta buggar och se om spelupplevelsen blev som vi tänkte oss.

\subsubsection{Scenario 1}

Användaren kör spelet och vi observerar och antecknar. Vi frågar användaren om spelmekaniken var tillfredsställande och om det uppstod några buggar. Vi ställer även öppna frågor för att få kvalitativa data.

\subsubsection{Resultat}
Användarna hade lite problem med att förstå kontrollerna för menyn, då de instinktivt gick efter musen istället för att styra med piltangenterna + enter i menyn. Vi märkte även att det blev lite problem med att ha en långsam updateringsfrekvens för menyn (0.5 s), detta gör man måste hålla ner enter för att välja saker, något som är kontraintuitivt.

Själva spelomgången gick bra, spelarna förstod genast vad spelet gick ut på och de hade kul när de spelade spelet. Fysiken i spelet verkar även den mycket lyckad då det är lite svårt att ha full kontroll på sitt skepp, men ändå styrbart.

Vid lite frågor visade det sig att spelarna inte hade sett att man hade liv samt att de inte förstod direkt att de gröna blobarna är öar.

Generellt sett så var de nöjda med sin spelupplevelse.

 

\subsection{C}
Unit-tester uteblev då vi aldrig fann behovet av dem. Ursprungligen tänkte vi bara använda unit-tester för några få saker så när de inte genomsyrade hela processen så var de lätta att glömma. Om vi verkligen skulle använda unit-tester så hade vi nog behövt tillämpa dem från första början.

Testet för navigation i menyn uteblev då den i slutändan inte hade tillräckligt med funktionalitet för att det skulle vara någon idé med ett test.

\section{Programdesign}
\subsection{A}
Vårat spel kommer ha en huvudklass (\ttt{Pirates}) som skapar alla olika objekt och har en spel-loop. Den kommer antagligen ha lite privata hjälpmetoder och möjligtvis någon metod för att kommunicera med andra klasser.

För att hantera grafik kommer vi skapa en \ttt{Window}-klass. Den kommer att hantera objekt som ärver den abstrakta klassen \ttt{Drawable} och rita dem när \ttt{Pirates} anropar \ttt{Window}s \ttt{draw()}-metod.

Alla ''fysiska'' objekt i spelet (\ttt{Boat}, \ttt{Cannonball} och \ttt{Island}) ärver från den abstrakta klassen \ttt{Entity} som ger \ttt{Pirates} ett gränssnitt för att uppdatera och hantera kollisioner mellan olika fysiska objekt. \ttt{Entity} ärver från \ttt{Drawable}.

Efter att ha ritat bilderna nedan inser vi att vi antagligen kommer behöva någon form av matris-hjälpklass för att kunna hantera acceleration i specifika riktningar och mer avancerad kollision samt vridning av objekt.

\begin{figure}[h!]
	\centering
	\includegraphics[width=0.5\textwidth]{Bilder/Class-diagram}
	\includegraphics[width=0.3\textwidth]{Bilder/Program_Flow}
	\caption{Klassdiagram och programflödesschema}
\end{figure}
\begin{figure}[h!]
	\centering
	\includegraphics[width=\textwidth]{Bilder/CLASSdiagramet}
	\caption{Ett klassdiagram med klass}
\end{figure}
\subsection{B}
Spelets huvudklass är \ttt{Pirates}, klassen innehåller main-loopen. Klassen har lite publika metoder för menyhanteringen samt lägga till och ta bort några olika objekt ur spelet.

\ttt{Window}-klassen beter sig lite annorlunda än planerat, den anropar draw på drawables och låter dem rita upp sig själva istället för att hämta värden från dem och sedan rita upp bilderna efter det. Denna approach visade sig vara väldigt bra för att rita grejer som inte är sprites rakt av.

Kollision och uppdatering/hantering av borttagning visade sig passa mycket bättre som två olika interfaces/abstrakta klasser, då alla objekt man kan kollidera med inte nödvändigtvis behöver uppdateras (t.ex. öar). \ttt{Entity} ärver dock fortfarande från \ttt{Drawable}.

För att hantera positioner, rotationer och kollisioner så skapade vi en klass \ttt{Point} som ärver från \ttt{Vector} som ärver från \ttt{Matrix}. Point representerar en 2D-vektor och innehåller bland annat funktioner för rotation, normalisering och multiplikation. Dessa klasser används väldigt intensivt vid kollisionshantering och för att hålla reda på positioner och fart.

Ett komplett klassdiagram hittar du i slutet av rapporten.

\subsection{C}
Det blev många fler klasser och interfaces än ursprungligen planerat. Detta beror dels på att vi insåg bättre designmönster under projektets gång, men även på att vi missat att tänka på vissa grejer såsom menyn. 

Vissa designval har allteftersom projektet fortskridit visat sig lite kunna göras på bättre sätt. T.ex. så insåg vi att main-metoden istället skulle kunna ligga på meny-klassen och så får Pirates istället vara en ren spel-klass. Vector har också visat sig vara ganska onödig. Vissa designval som kändes helt uppenbara när de gjordes visar sig i längen vara lite konstiga.

Detta visar på att en iterativ designprocess för programstrukturen är rätt bra. För det är viktigt med ett väldesignat program för att ha ett program som enkelt kan utvidgas och underhållas.

\section{Tekniska specifikationer}
	\begin{itemize}
		\item Spelet ska kunna hantera olika framerates.
		\item Spelarnas båtar ska accelerera/deaccelerera.
		\item Spelet ska ha ett poängsystem.
	\end{itemize}

\section{Tidsplan}

\subsection{A}
För tillfället har vi delat upp vår tid med projektet i tre perioder. Period 1 är dagarna mellan övningen fredagen 08/05 och övningen onsdagen 13/05, period 2 är från 13/05 till söndagen 17/05 och period 3 är från måndagen 18/05 till sista övningen 22/05.

Under första perioden vill vi skapa en körbar alphaverison. Denna version vill vi sedan användartesta under period 2 för att få feedback. I period 3 vill vi sedan använda feedbacken för att göra en slutgiltig version.

\subsection{B}
Vårt mål att ha en spelbar version till den 13/05 uppnåddes inte fullt. Användartester hamnade då efter och kunde inte utföras i den utsträckning som vi ursprungligen planerade. Perioder med användartester och kodning flöt samman och blev i slutändan inte så väldefinierade som vi hade planerat.

\subsection{C}
Programmet kunde köras men var inte så fullbordat som vi hade hoppats på, problemet var att kollision med öar tog längre tid än förväntat. Vi var nog även lite väl optimistiska i vår tidsplan, både som tidsoptimister, men även att Alexander som gjorde stora delar av tidsplanen inte uppskattade korrekt hur snabbt August skulle lära sig hur man arbetar med versionshantering. Detta samt att vi har varit lite dåliga på att dela upp arbetet ordentligt vilket gjort att vi inte riktigt varit säkra på vad vi ska göra. Kommunikation är $A$ och $\Omega$ med andra ord.

\section{Sammanfattning}
Vi har lärt oss väldigt mycket från projektet. Bland annat:
\begin{itemize}
	\item Vad som är viktigt vid arbete med kod i grupp.
	\item Hur man arbetar med grafik.
	\item Git
	\item Att kollision kan vara en pain in the ass.
	\item Mer erfarenhet av arbete med större mängder kod
	\item Att läsa igenom och förstå andras kod, framförallt när den är halvslafsigt skriven
	\item En algoritm för konvexa skal
	\item Testning är viktigt, men lite tråkigt
	\item Det är bra att skriva rapport under projektets gång, och inte klämma in det i slutet
	\item Att IntelliJ är riktigt najs. Skolans linux är mindre najs.
\end{itemize}

\end{document}
